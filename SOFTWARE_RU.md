## Участники
- Артемьев М. А. - 5130904/30104
- Никитов Д. В. - 5130904/30104
- Бабинов С. А. - 5130904/30104
- Жалилов Р. Ш. - 5130904/30103

## Проблема
С уходом компании SAP демонстрационный стенд, созданный для презентации возможностей SAP ERP, утратил свою актуальность. Также вместо того чтобы быть наглядным доказательством мощи и современности «1С», способной управлять IoT и работать в реальном времени, стенд опровергает устаревший стереотип о системе как о сугубо бухгалтерском инструменте.

## Функциональные требования
1. Система должна предоставлять выбор несколько изделий для запуска в производство через дашборд;
2. На дашборде должна выводиться вся информация о производстве;
3. Должна быть реализована команда, которая сортирует изделия на складе;
4. Необходимо сделать документ с привязкой цветов к координатам ячеек склада.

## Пользовательские сценарии
1. Обработка выбранных изделий:
   Я хочу выбрать на дашборде в 1С:Предприятие 8.5 (далее - 1С) несколько изделий для производства, чтобы увидеть, как манипулятор берет детали со склада, отправляет их в покрасочно-лакировачный цех и доставляет на сортировочную станцию. В процессе производственного цикла я хочу видеть состояние и загруженность каждого компонента на дашборде, чтобы отслеживать общее состояние макета.

2. Сортировка изделий по цвету:
   Я хочу инициировать команду сортировки на складе, чтобы манипулятор автоматически рассортировал детали на складе по цветам, а дашборд в 1С в реальном времени отобразил новое состояние склада. В результате, детали на физическом складе должны быть упорядочены, а данные на дашборде 1С должны соответствовать физическому расположению.

3. Инициализация состояния склада:
   Я хочу провести в систему документ, в котором указаны координаты и соответствующие им цвета для каждой ячейки склада, чтобы обновить информацию о складе на дашборде. В результате, данные в системе 1С должны быть полностью синхронизированы с физическим состоянием стенда после выполнения команды.

## Расчет нагрузки
В данном проекте высокое соотношение чтения к записи - примерно 80% на 20%.

**Read-операции** (вызываются автоматически, поэтому частые):
- GET /get_storage - постоянный мониторинг состояния склада каждые 20 секунд. За 1 час формируются 180 запросов (3600/20)
- GET /get_status - отслеживание статуса компонентов каждые 30 секунд. За 1 час формируются 120 запросов (3600/30)
- GET /queue_status - мониторинг выполнения задач каждые 45 секунд. За 1 час формируются 120 запросов (3600/45 + дополнительные проверки перед операциями)

**Write-операции** (вызываются по действию пользователя, поэтому менее частые):
- POST /process_cargos - обработка грузов каждые 53 секунды. За 1 час формируются 68 операций (3600/53)
- POST /sort_cargos - полный цикл сортировки каждые 2.4 минуты. За 1 час формируются 25 операций (60/2.4)
- POST /return_cargos - возврат грузов каждые 4.6 минуты. За 1 час формируются 13 операций (60/4.6)
- POST /write_storage - изменение конфигурации склада каждые 7.5 минут. За 1 час формируются 8 операций (60/7.5)

**Итог за 1 час:**
- Всего Read-операций: 180 + 120 + 120 = 420 операций (75.7%)
- Всего Write-операций: 68 + 25 + 13 + 8 = 114 операций (24.3%)
- Общее количество: 534 операции в час

## Схемы проектирования

**Контекстная диаграмма**

<img width="196" height="340" alt="{E81A95C8-5F00-443B-BBA2-9864630F07D2}" src="https://github.com/user-attachments/assets/a5fd4625-5ce0-4a0e-95a6-e367dd2ee1d3" />



**Контейнерная диаграмма**

<img width="399" height="633" alt="{EF3EB658-C117-4F15-BD08-EDCB58C184FD}" src="https://github.com/user-attachments/assets/a0dd3856-a4c0-4127-b92a-a4af4162b2d3" />

- 1С Клиент - Программа, через которую пользователь управляет макетом и получает информацию о процессе;
- Nginx - ПО, которое принимает запросы от 1С и передает их основной программе;
- FastAPI Server - основное приложение, которое обрабатывает API запросы и управляет всей системой;
- Task Queue Manager - компонент, который управляет очередью задач и отслеживает статус выполнения операций;
- Async Executer - компонент, который выполняет задачи асинхронно и обеспечивает параллельную обработку операций;
- Config Manager - компонент, который хранит настройки системы и управляет конфигурацией оборудования;
- Hardware Abstraction Layer - слой абстракции, который переводит команды программы на "язык" оборудования:
  - Real Mode Controller - контроллер, который управляет реальным физическим оборудованием;
  - Hardware Validator - компонент, который проверяет корректность команд и состояние оборудования;
- Storage - складская матрица 3x3, где хранятся изделия;
- Crane - кран, который перемещает грузы между ячейками склада;
- Paint and polish centers - центры покраски и полировки грузов;
- Sort center - центр сортировки, который идентифицирует и распределяет фишки по типам.

